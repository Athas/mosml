<HTML><HEAD><TITLE>Structure Polygdbm</TITLE></HEAD>
<BODY BGCOLOR="#fbf2e7">
<H1>Structure Polygdbm</H1>
<HR><TABLE WIDTH=100%><TR ALIGN = CENTER>
<TH><A HREF="idIndex.html">Identifier index</A>
<TH><A HREF="index.html">Structure index</A>
</TABLE><HR>
<PRE>
<A NAME="line1"></A>(* Polygdbm -- interface to GNU gdbm, persistent polymorphic hashtables 
<A NAME="line2"></A>   Version 0.0, 1997-11-09
<A NAME="line3"></A>*)
<A NAME="line4"></A>
<A NAME="line5"></A>type <A NAME="line5"></A>('key, 'data) table 
<A NAME="line6"></A>
<A NAME="line7"></A>(* Read-only access is non-exclusive; read/write access excludes others *)
<A NAME="line8"></A>
<A NAME="line9"></A>exception NotFound
<A NAME="line10"></A>exception AlreadyThere
<A NAME="line11"></A>exception NotWriter
<A NAME="line12"></A>exception Closed
<A NAME="line13"></A>exception GdbmError of string
<A NAME="line14"></A>
<A NAME="line15"></A>val <A NAME="line15"></A><A HREF="#withtable">withtable</A>  : string * Gdbm.openmode -&gt; (('key, 'data) table -&gt; 'a) -&gt; 'a
<A NAME="line16"></A>val <A NAME="line16"></A><A HREF="#add">add</A>        : ('key, 'data) table -&gt; 'key * 'data -&gt; unit 
<A NAME="line17"></A>val <A NAME="line17"></A><A HREF="#insert">insert</A>     : ('key, 'data) table -&gt; 'key * 'data -&gt; unit
<A NAME="line18"></A>val <A NAME="line18"></A><A HREF="#find">find</A>       : ('key, 'data) table -&gt; 'key -&gt; 'data
<A NAME="line19"></A>val <A NAME="line19"></A>peek       : ('key, 'data) table -&gt; 'key -&gt; 'data option
<A NAME="line20"></A>val <A NAME="line20"></A><A HREF="#hasKey">hasKey</A>     : ('key, 'data) table -&gt; 'key -&gt; bool
<A NAME="line21"></A>val <A NAME="line21"></A><A HREF="#remove">remove</A>     : ('key, 'data) table -&gt; 'key -&gt; unit
<A NAME="line22"></A>val <A NAME="line22"></A><A HREF="#listKeys">listKeys</A>   : ('key, 'data) table -&gt; 'key list
<A NAME="line23"></A>val <A NAME="line23"></A><A HREF="#numItems">numItems</A>   : ('key, 'data) table -&gt; int
<A NAME="line24"></A>val <A NAME="line24"></A><A HREF="#listItems">listItems</A>  : ('key, 'data) table -&gt; ('key * 'data) list
<A NAME="line25"></A>val <A NAME="line25"></A><A HREF="#app">app</A>        : ('key * 'data -&gt; unit) -&gt; ('key, 'data) table -&gt; unit
<A NAME="line26"></A>val <A NAME="line26"></A><A HREF="#map">map</A>        : ('key * 'data -&gt; 'a) -&gt; ('key, 'data) table -&gt; 'a list
<A NAME="line27"></A>val <A NAME="line27"></A><A HREF="#fold">fold</A>       : ('key * 'data * 'a -&gt; 'a) -&gt; 'a -&gt; ('key, 'data) table -&gt; 'a
<A NAME="line28"></A>val <A NAME="line28"></A><A HREF="#fastwrite">fastwrite</A>  : bool ref    
<A NAME="line29"></A>val <A NAME="line29"></A><A HREF="#reorganize">reorganize</A> : ('key, 'data) table -&gt; unit
<A NAME="line30"></A>
<A NAME="line31"></A>(* 
<A NAME="line32"></A>
<A NAME="line33"></A>   The type [('key, 'data) table] is the type of an opened table with
<A NAME="line34"></A>   keys of type 'key and associated values of type 'data.  The actual
<A NAME="line35"></A>   values of type 'key and 'data cannot contain function closures or
<A NAME="line36"></A>   abstract values.  Values involving references (even circular
<A NAME="line37"></A>   values) can be stored, but the identity of references is preserved
<A NAME="line38"></A>   only with every single key or value stored, not across several
<A NAME="line39"></A>   different values.  
<A NAME="line40"></A>
<A NAME="line41"></A>   The Polygdbm table files of are not portable across platforms,
<A NAME="line42"></A>   because word size and endianness affects the lay-out of values.
<A NAME="line43"></A>
<A NAME="line44"></A>   Note that the table can be used only inside the withtable function,
<A NAME="line45"></A>   to make sure that the table is closed after use.
<A NAME="line46"></A>    
   [<A NAME="withtable"><B>withtable</B></A> (nam, mod) f] first opens the table db in file nam with
   mode mod, then applies f to db, then closes db.  Makes sure to
   close db even if an exception is raised during the evaluation of
   f(db).  Raises GdbmError with an informative message in case the
   table cannot be opened.  E.g. the table cannot be opened for
   reading if already opened for writing, and cannot be opened for
   writing if already opened for reading.

   [<A NAME="add"><B>add</B></A> db (k,v)] adds the pair (k, v) to db.  Raises AlreadyThere if
   there is a pair (k, _) in db already.  Raises NotWriter if db is
   not opened in write mode.

   [<A NAME="insert"><B>insert</B></A> db (k, v)] adds the pair (k, v) to db, replacing any pair
   (k, _) at k if present.  Raises NotWriter if db is not opened in
   write mode.

   [<A NAME="find"><B>find</B></A>(db, k)] returns v if the pair (k, v) is in db; otherwise
   raises NotFound.

   [<A NAME="hasKey"><B>hasKey</B></A>(db, k)] returns true if there is a pair (k, _) in db;
   otherwise returns false.

   [<A NAME="remove"><B>remove</B></A> db k] deletes the pair (k, _) from the table if present;
   otherwise raises NotFound.  Raises NotWriter if db is not opened in
   write mode.

   [<A NAME="listKeys"><B>listKeys</B></A> db] returns a list of all keys in db in an unspecified
   order.  

   [<A NAME="numItems"><B>numItems</B></A> db] is the number of (key, value) pairs in db.
   Equivalent to length(listKeys db).

   [<A NAME="listItems"><B>listItems</B></A> db] returns a list of all (key, value) pairs in db in some 
   order.  Equivalent to 
        List.map (fn key =&gt; (key, find(db,key))) (listKeys db)

   [<A NAME="app"><B>app</B></A> f db] is equivalent to List.app f (listItems db), provided the
   function f does not change the set of keys in the table.
   Otherwise the effect is unpredictable.

   [<A NAME="map"><B>map</B></A> f db] is equivalent to List.map f (listItems db), provided the
   function f does not change the set of keys in the table.
   Otherwise the result and effect are unpredictable.
   
   [<A NAME="fold"><B>fold</B></A> f a db] is equivalent to 
        List.foldr (fn ((k, v), r) =&gt; f(k, v, r)) a (listItems db)
   provided the function f does not change the set of keys in the 
   table. Otherwise the result and effect are unpredictable.

   [<A NAME="fastwrite"><B>fastwrite</B></A>] can be set to speed up writes to a table.  By default,
   !fastwrite is false and every write to a table will be followed by
   file system synchronization.  This is safe, but slow if you perform
   thousands of writes.  However, if !fastwrite is true when calling
   withtable, then writes may not be followed by synchronization,
   which may speed up writes considerably.  In any case, the file
   system is synchronized before withtable returns.

   [<A NAME="reorganize"><B>reorganize</B></A> db] has no visible effect, but may be called after a
   lot of deletions to shrink the size of the table file.
*)

</PRE><HR><TABLE WIDTH=100%><TR ALIGN = CENTER>
<TH><A HREF="idIndex.html">Identifier index</A>
<TH><A HREF="index.html">Structure index</A>
</TABLE><HR>
<BR><EM>Moscow ML 1.44</EM></BODY></HTML>
